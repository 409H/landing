<!DOCTYPE html>
<html>
<head>
  <title>build.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="doc-style.css" />
  <script src="doc-filelist.js"></script>
  <script>
    var relativeDir = "";
    var thisFile = "build.js";
    var defaultSidebar = true;
  </script>
  <script src="doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>build.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>)
<span class="hljs-keyword">const</span> fsExtra = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs-extra'</span>)
<span class="hljs-keyword">const</span> rmRf = <span class="hljs-built_in">require</span>(<span class="hljs-string">'rimraf'</span>)

<span class="hljs-keyword">const</span> Streams = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mississippi'</span>)
<span class="hljs-keyword">const</span> bind = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ap'</span>).partial
<span class="hljs-keyword">const</span> <span class="hljs-keyword">async</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./async'</span>)

<span class="hljs-keyword">const</span> Browserify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'browserify'</span>)
<span class="hljs-keyword">const</span> watchify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'watchify'</span>)
<span class="hljs-keyword">const</span> sassStream = <span class="hljs-built_in">require</span>(<span class="hljs-string">'sass-css-stream'</span>)




start(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>)</span>{
  <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'end'</span>)
})


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">start</span>(<span class="hljs-params">cb</span>)</span>{
  <span class="hljs-keyword">async</span>.series({
    clean,
    build,
  }, cb)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clean</span>(<span class="hljs-params">cb</span>)</span>{
  fsExtra.remove(<span class="hljs-string">'./dist/'</span>, cb)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">build</span>(<span class="hljs-params">cb</span>)</span>{
  <span class="hljs-keyword">async</span>.parallel({
    buildJs,
    buildCss,
    buildStatic,
  }, cb)
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildJs</span>(<span class="hljs-params">cb</span>) </span>{
  <span class="hljs-keyword">var</span> browserify = Browserify({
    entries: [<span class="hljs-string">'./src/js/index.js'</span>],
    cache: {},
    packageCache: {},
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>plugin: [watchify],</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  })

  browserify.on(<span class="hljs-string">'update'</span>, bundle)

  <span class="hljs-keyword">async</span>.series({
    buildJsPrep: bind(fsExtra.mkdirs, <span class="hljs-string">'./dist/js'</span>),
    buildJsStart: start,
  }, cb)

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">start</span>(<span class="hljs-params">cb</span>)</span>{
    <span class="hljs-keyword">var</span> firstBundle = bundle()
    Streams.finished(firstBundle, cb)
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bundle</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'bundle'</span>)
    <span class="hljs-keyword">return</span> Streams.pipeline(
      browserify.bundle(),
      fs.createWriteStream(<span class="hljs-string">'./dist/js/bundle.js'</span>)
    )
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildCss</span>(<span class="hljs-params">cb</span>) </span>{
  
  <span class="hljs-keyword">async</span>.series({
    buildCssPrep: bind(fsExtra.mkdirs, <span class="hljs-string">'./dist/css'</span>),
    buildCssStart: start,
  }, cb)

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">start</span>(<span class="hljs-params">cb</span>) </span>{
    <span class="hljs-keyword">var</span> pipeline = Streams.pipeline(
      fs.createReadStream( <span class="hljs-string">'./src/css/index.scss'</span> ),
      sassStream( <span class="hljs-string">'./src/css/index.scss'</span> ),
      fs.createWriteStream( <span class="hljs-string">'./dist/css/bundle.css'</span> )
    )
    Streams.finished(pipeline, cb)
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buildStatic</span>(<span class="hljs-params">cb</span>) </span>{

  <span class="hljs-keyword">async</span>.parallel({
    imgs: bind(fsExtra.copy, <span class="hljs-string">'./src/img/'</span>, <span class="hljs-string">'./dist/img/'</span>),
    fonts: bind(fsExtra.copy, <span class="hljs-string">'./src/fonts/'</span>, <span class="hljs-string">'./dist/fonts/'</span>),
    html: bind(fsExtra.copy, <span class="hljs-string">'./src/index.html'</span>, <span class="hljs-string">'./dist/index.html'</span>),
    goog: bind(fsExtra.copy, <span class="hljs-string">'./src/google3bfcd95a7b5008a9.html'</span>, <span class="hljs-string">'./dist/google3bfcd95a7b5008a9.html'</span>),
  }, cb)

}

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
